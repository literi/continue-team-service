# 需求细化文档

## 1. MCP协议对接标准
- **协议版本**：兼容Continue官方最新MCP协议规范。
- **核心接口**：
  - `POST /sessions`: 创建会话
  - `POST /sessions/{id}/context`: 添加上下文
  - `GET /sessions/{id}/context`: 获取上下文
  - `DELETE /sessions/{id}`: 销毁会话
- **数据格式**：JSON格式，字段需严格对齐官方定义。

## 2. 多租户权限矩阵
| 角色 | 租户管理 | 项目管理 | 用户管理 | 知识库读写 | Skill执行 | 配置修改 |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: |
| 平台管理员 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 团队管理员 | ❌ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 项目负责人 | ❌ | ❌ | ❌ | ✅ | ✅ | ⚠️(仅项目级) |
| 普通开发者 | ❌ | ❌ | ❌ | ⚠️(仅读) | ✅ | ❌ |

## 3. Skill白名单与沙箱策略
- **白名单机制**：
  - 默认禁止所有高危操作（如 `rm -rf`, `systemctl` 等）。
  - 允许列表需由团队管理员配置。
- **沙箱策略**：
  - 所有Skill执行均在Docker容器中运行。
  - 容器网络受限，仅允许访问特定白名单域名。
  - 挂载目录仅限项目工作区，禁止访问宿主机系统目录。
